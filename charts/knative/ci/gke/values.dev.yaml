# Development environment values for Knative chart on GKE

# Namespace for development
namespace: dev

# Knative Serving Configuration
serving:
  enabled: true
  
  # Service configuration
  service:
    enabled: true
    name: knative-service-dev
    # Service metadata
    labels:
      environment: dev
      team: platform
    annotations: {}  # keep empty; autoscaling annotations go under template.metadata.annotations

    # Service spec
    template:
      metadata:
        labels:
          environment: dev
          version: dev
        annotations:
          # Development-specific autoscaling annotations
          autoscaling.knative.dev/minScale: "0"
          autoscaling.knative.dev/maxScale: "5"
          autoscaling.knative.dev/target: "50"
      spec:
        containerConcurrency: 10  # Lower concurrency for dev
        timeoutSeconds: 300

        containers:
          - name: user-container
            image: gcr.io/knative-samples/helloworld-go:latest
            ports:
              - containerPort: 8080
                protocol: TCP
            env:
              - name: ENVIRONMENT
                value: "dev"
              - name: LOG_LEVEL
                value: "debug"
            resources:
              # Lower resource limits for development
              limits:
                cpu: 500m
                memory: 512Mi
              requests:
                cpu: 50m
                memory: 128Mi
            livenessProbe:
              httpGet:
                path: /
                port: 8080
              initialDelaySeconds: 0
            readinessProbe:
              httpGet:
                path: /
                port: 8080
              initialDelaySeconds: 0
    
    # Traffic configuration
    traffic:
      - revisionName: ""
        percent: 100
        latestRevision: true
        tag: ""
    
    # Visibility configuration - public for dev
    visibility: ""  # Empty means public

  # Route configuration (optional)
  route:
    enabled: false

  # Configuration (optional)
  configuration:
    enabled: false

# Knative Eventing Configuration (optional for dev)
eventing:
  enabled: false
  
  # Broker configuration
  broker:
    enabled: false
    name: default
  
  # Trigger configuration
  trigger:
    enabled: false
  
  # Source configurations
  source:
    ping:
      enabled: false
    apiserver:
      enabled: false
    container:
      enabled: false

# Autoscaling configuration for development (chart-level, not Knative annotations)
autoscaling:
  enabled: true
  minScale: 0  # Scale to zero in dev
  maxScale: 5  # Lower max scale for dev
  target: 50   # Lower target concurrency for dev
  annotations: {}  # leave empty; Knative annotations handled above

# Service Account
serviceAccount:
  create: true
  name: ""
  annotations: {}
  labels:
    environment: dev

# Pod Disruption Budget (disabled for dev)
podDisruptionBudget:
  enabled: false

# Network Policy (disabled for dev)
networkPolicy:
  enabled: false
